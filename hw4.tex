\documentclass{article}\usepackage[]{graphicx}\usepackage[]{color}
%% maxwidth is the original width if it is less than linewidth
%% otherwise use linewidth (to make sure the graphics do not exceed the margin)
\makeatletter
\def\maxwidth{ %
  \ifdim\Gin@nat@width>\linewidth
    \linewidth
  \else
    \Gin@nat@width
  \fi
}
\makeatother

\definecolor{fgcolor}{rgb}{0.345, 0.345, 0.345}
\newcommand{\hlnum}[1]{\textcolor[rgb]{0.686,0.059,0.569}{#1}}%
\newcommand{\hlstr}[1]{\textcolor[rgb]{0.192,0.494,0.8}{#1}}%
\newcommand{\hlcom}[1]{\textcolor[rgb]{0.678,0.584,0.686}{\textsf{#1}}}%
\newcommand{\hlopt}[1]{\textcolor[rgb]{0,0,0}{#1}}%
\newcommand{\hlstd}[1]{\textcolor[rgb]{0.345,0.345,0.345}{#1}}%
\newcommand{\hlkwa}[1]{\textcolor[rgb]{0.161,0.373,0.58}{\textbf{#1}}}%
\newcommand{\hlkwb}[1]{\textcolor[rgb]{0.69,0.353,0.396}{#1}}%
\newcommand{\hlkwc}[1]{\textcolor[rgb]{0.333,0.667,0.333}{#1}}%
\newcommand{\hlkwd}[1]{\textcolor[rgb]{0.737,0.353,0.396}{\textbf{#1}}}%

\usepackage{framed}
\makeatletter
\newenvironment{kframe}{%
 \def\at@end@of@kframe{}%
 \ifinner\ifhmode%
  \def\at@end@of@kframe{\end{minipage}}%
  \begin{minipage}{\columnwidth}%
 \fi\fi%
 \def\FrameCommand##1{\hskip\@totalleftmargin \hskip-\fboxsep
 \colorbox{shadecolor}{##1}\hskip-\fboxsep
     % There is no \\@totalrightmargin, so:
     \hskip-\linewidth \hskip-\@totalleftmargin \hskip\columnwidth}%
 \MakeFramed {\advance\hsize-\width
   \@totalleftmargin\z@ \linewidth\hsize
   \@setminipage}}%
 {\par\unskip\endMakeFramed%
 \at@end@of@kframe}
\makeatother

\definecolor{shadecolor}{rgb}{.97, .97, .97}
\definecolor{messagecolor}{rgb}{0, 0, 0}
\definecolor{warningcolor}{rgb}{1, 0, 1}
\definecolor{errorcolor}{rgb}{1, 0, 0}
\newenvironment{knitrout}{}{} % an empty environment to be redefined in TeX

\usepackage{alltt}

\usepackage[utf8]{inputenc}
%\usepackage[cp1251]{inputenc}
\usepackage[english]{babel}
\usepackage{indent first}
\usepackage[top=2 cm, bottom = 2 cm, left = 3 cm, right = 1.5 cm]{geometry}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{graphicx}
\usepackage{wrapfig}
\usepackage{listings}
\usepackage{ mathrsfs }
\usepackage{subcaption}
\graphicspath{{images/}}
\renewcommand{\baselinestretch}{1.1}

\newtheorem*{theorem}{Theorem}
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\begin{document}
%<*includetag>
\section{Assignment 4}
\subsection{Selection and building nominal features}
In our dataset we have several binary features, such as weekdays (\texttt{weekday\_is\_monday}, \texttt{weekday\_is\_tuesday} and so on) and belonging to one of the channels (\texttt{data\_channel\_is\_lifestyle}, \texttt{data\_channel\_is\_entertainment} and so on). Therefore we built two nominal features:
\begin{itemize}
\item channel: integer values ranging between 1 and 6 ('Lifestyle', 'Entertainment', 'Business', 'Social Media', 'Tech', 'World')
\item weekday: integer values ranging between 1 and 7 
\end{itemize}

To obtain the third nominal feature we divide into four parts the feature \texttt{timedelta}: days between the article publication and the dataset acquisition.
\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}  
\hlstd{timegroup} \hlkwb{<-} \hlkwa{cut}\hlstd{(data$timedelta, breaks = 4})
\end{alltt}
\end{kframe}
\end{knitrout} 

And we break range of values of \texttt{timedelta} into intervals: $(7.28,189]$, $(189,370]$, $(370,550]$, $(550,732]$

\subsection{Contingency tables over features}
Conditional frequency tables over introdused nominal fetures are obtained with R-function \texttt{table} as showned below and results are presented at Tables \ref{tbl:cont_table_ch_timed} -- \ref{tbl:cont_table_timed_week}.
\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}  
table(data$channel, data$timegroup)
table(data$channel, data$weekday)
\end{alltt}
\end{kframe}
\end{knitrout} 

\begin{table}[h]
\begin{center}
\small
\begin{minipage}[h]{0.45\linewidth}
\caption{Conditional frequency table over \texttt{channel} and \texttt{timegroup}} \label{tbl:cont_table_ch_timed}
\begin{tabular}{|c|c|c|c|c|} 
 \hline
  &(7.28,189] &(189,370]& (370,550] &(550,732] \\ \hline
  0  &      412   &    327   &    361   &    381 \\ \hline
  1  &      120   &     93   &    130   &    183 \\ \hline
  2  &      573   &    473   &    341   &    348 \\ \hline
  3  &      392   &    408   &    410   &    446 \\ \hline
  4  &       81   &    154   &    163   &    192 \\ \hline
  5  &      401   &    469   &    491   &    492 \\ \hline
  6  &      901   &    564   &    373   &    321 \\ \hline
\end{tabular}
\end{minipage}
\hfill 
\begin{minipage}[h]{0.45\linewidth}
\caption{Conditional frequency table over \texttt{channel} and \texttt{weekday}} \label{tbl:cont_table_ch_week}
\begin{tabular}{|c|c|c|c|c|c|c|c|} 
 \hline
     &1 & 2 & 3 & 4 & 5 & 6 & 7 \\ \hline
  0  & 224 & 256 &253 &257 &238 &112 &141 \\ \hline
  1  & 80 & 95 &  92 & 85  &69  &46  &59 \\ \hline
  2  & 317 & 332 & 311 & 287 & 241 & 95 & 152 \\ \hline
  3  & 277 & 293 & 371 & 319 & 245 & 57 & 94 \\ \hline
  4  & 88 & 116 &105& 115 & 88 & 44 & 34 \\ \hline
  5  & 316 & 372 & 358 & 344 & 244 & 125 & 94\\ \hline
  6  & 360& 379& 399& 392& 342& 136& 151 \\ \hline
\end{tabular}
\end{minipage}
\end{center}
\end{table}

Quetelet relative index tables over our nominal fetures we obtain with the function:
\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}  
getQueteletIndex \hlkwb{<-} \hlkwa{function}(v1, v2) {
  size \hlkwb{<-} length(v1)
  cont.table  \hlkwb{<-} table(v1, v2)
  row.sums  \hlkwb{<-} rowSums(cont.table)
  col.sums  \hlkwb{<-} colSums(cont.table)
  norm.cont.table  \hlkwb{<-}  cont.table / size
  norm.row.sums  \hlkwb{<-} row.sums / size
  norm.col.sums  \hlkwb{<-} col.sums / size
  list(Quetelet = norm.cont.table / (norm.row.sums %*% t(norm.col.sums)) - 1,
       PearsonIndexMatrix = (-norm.row.sums %*% t(norm.col.sums) + norm.cont.table) /
          sqrt(norm.row.sums %*% t(norm.col.sums)))
}
\end{alltt}
\end{kframe}
\end{knitrout}

The results (in percent) are  presented at Tables \ref{tbl:quet_table_ch_timed}, \ref{tbl:quet_table_ch_week}. 
\begin{table}[h]
\footnotesize
\begin{center}
\begin{minipage}[h]{0.4\linewidth}
\caption{Quetelet relative index table over \texttt{channel} and \texttt{timegroup}} \label{tbl:quet_table_ch_timed}
\begin{tabular}{|c|c|c|c|c|} 
 \hline
  &(7.28,189] &(189,370]& (370,550] &(550,732] \\ \hline
  0&      -3.41  &  -11.26&      7.43&      8.87 \\ \hline
  1 &    -20.79  &  -28.94&      8.92&\textbf{47.23} \\ \hline
  2  &14.67 &\textbf{9.57}&    -13.38&    -15.12 \\ \hline
  3&     -17.81 &    -0.97&      9.12&     13.98 \\ \hline
  4 &    -52.33 & 4.91&\textbf{21.76}&     37.72 \\ \hline
  5  &   -24.86&      1.73&     16.78&     12.36 \\ \hline
  6&\textbf{44.90}&   5.00&    -23.86&    -37.08 \\ \hline
\end{tabular}
\end{minipage}
\hfill 
\begin{minipage}[h]{0.5\linewidth}
\caption{Quetelet relative index table over \texttt{channel} and \texttt{weekday}} \label{tbl:quet_table_ch_week}
\begin{tabular}{|c|c|c|c|c|c|c|c|} 
 \hline
     &1 & 2 & 3 & 4 & 5 & 6 & 7 \\ \hline
  0  &-9.00&  -6.21&  -9.57&  -3.54 &  9.54&  22.97&  31.32 \\ \hline
  1 & -8.49&  -2.00&  -7.41& -10.17 &-10.58&\textbf{42.20}&\textbf{54.71}\\ \hline
  2&\textbf{9.93}&   3.83&  -5.11&  -8.05 & -5.31& -10.97&  20.84 \\ \hline
  3&   0.64&  -4.00&\textbf{18.60}&   7.08 &  0.85& -44.03& -21.71 \\ \hline
  4& -10.26&   6.68&  -5.79&\textbf{8.35}&  1.67&  21.26& -20.51 \\ \hline
  5&   2.61&\textbf{8.93}&   2.28&   3.19 &-10.24&   9.69& -30.03 \\ \hline
  6&   0.33&  -4.75&  -2.17&   0.93 &\textbf{7.98}&   2.43&  -3.53 \\ \hline
\end{tabular}
\end{minipage}
\end{center}
\end{table}

As we can see from the Table \ref{tbl:quet_table_ch_timed}, \texttt{timegroup} is dependent with \texttt{channel} in some values. For example, we observe rather big Quetelet relative index between \textsf{Entartanment channel} and \textsf{4th time-group}. \footnote{WHY????}
In addition, we can't reject a dependence between \textsf{World channel} and \textsf{1st time-group}. It can be caused by not random sampling or by some extra-ordinary events with great response in the world.

Table \ref{tbl:quet_table_ch_week} provides us less surprising and more predictable results: all channels are almost independent with weekdays inspite of \textsf{Entartanment channel} and \textsf{Weekend}. This result is easy to understand: users visit Mashable at weekends to amuse themselves. \footnote{To fix.}


\subsection{$\chi^2$--summary Quetelet index}


\begin{table}[ht]
\centering
\begin{tabular}{|c|c|c|c|c|c|}
  \hline
 &(7.28,189] & (189,370] & (370,550] & (550,732] & Sum \\ 
  \hline
0 & -0.007 (0.00005) & -0.02161 (0.0004) & 0.01362 (0.0002) & 0.01659 (0.0003) & (0.00098) \\  \hline
1 & -0.02558 (0.0006) & -0.03310 (0.001) & 0.00975 (0.0001) & 0.05266 (0.003)  & (0.0046)  \\ \hline
2 & 0.03280 (0.001) & 0.01989 (0.0004) & -0.02655 (0.0007) & -0.03061 (0.0009) & (0.003)   \\ \hline
3 & -0.03889 (0.0015) & -0.00198 (0) & 0.01767 (0.0003) & 0.02765 (0.0008)     & (0.0026)  \\ \hline
4 & -0.06821 (0.0047) & 0.00595  (0.00004) & 0.02518 (0.0006) & 0.04453 (0.002)& (0.0073) \\ \hline
5 & -0.05743 (0.0033) & 0.00371 (0.00001) & 0.03441 (0.0012) & 0.02587 (0.0006)& (0.005)  \\ \hline
6 & 0.11197 (0.013) & 0.01158 (0.00013) & -0.05281 (0.00279) & -0.08375 (0.007)& (0.0225)  \\ \hline
Sum & (0.0237)      & (0.002)			& (0.006)			 & (0.0144)		   & (0.04624) \\ \hline
\end{tabular}
\caption{$\chi^2$--summary Quetelet index over \texttt{channel} and \texttt{timegroup}} \label{tbl:quet_table_ch_week}
\end{table}

\begin{table}[ht]
\centering
\footnotesize
\begin{tabular}{|c|c|c|c|c|c|c|c|c|}
  \hline
 & 1 & 2 & 3 & 4 & 5 & 6 & 7 & Sum \\ 
  \hline
0 & -0.014  (0) & -0.01  (0) & -0.016  (0) & -0.006  (0) & 0.014  (0) & 0.022  (0) & 0.032  (0.001) & (0.002) \\  \hline
1 & -0.008  (0) & -0.002  (0) & -0.007  (0) & -0.01  (0) & -0.009  (0) & 0.024  (0.001) & 0.034  (0.001) & (0.002) \\  \hline
2 & 0.017  (0) & 0.007  (0) & -0.009  (0) & -0.014  (0) & -0.008  (0) & -0.011  (0) & 0.023  (0.001) & (0.001) \\  \hline
3 & 0.001  (0) & -0.007  (0) & 0.033  (0.001) & 0.012  (0) & 0.001  (0) & -0.044  (0.002) & -0.024  (0.001) & (0.004) \\  \hline
4 & -0.01  (0) & 0.007  (0) & -0.006  (0) & 0.009  (0) & 0.002  (0) & 0.013  (0) & -0.013  (0) & (0.001) \\  \hline
5 & 0.005  (0) & 0.017  (0) & 0.004  (0) & 0.006  (0) & -0.017  (0) & 0.01  (0) & -0.035  (0.001) & (0.002) \\  \hline
6 & 0.001  (0) & -0.009  (0) & -0.004  (0) & 0.002  (0) & 0.014  (0) & 0.003  (0) & -0.004  (0) & (0) \\  \hline
Sum & (0.001) & (0.001) & (0.002) & (0.001) & (0.001) & (0.003) & (0.005) &  (0.0124)\\ 
   \hline
\end{tabular}
\caption{$\chi^2$--summary Quetelet index over \texttt{channel} and \texttt{weekday}} \label{tbl:quet_table_ch_week}
\end{table}

%</includetag>
\end{document}
