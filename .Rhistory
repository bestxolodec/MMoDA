library(lattice)
library(e1071)
set.seed(123)
online.news.popularity <- read.csv(file="new_sample_OnlineNewsPopularity.csv",head=TRUE,sep=",")
normalize.range <- function(x) {
midrange <- (max(x) + min(x))/2
halfrange <- (max(x) - min(x))/2
y <- (x - midrange)/halfrange
y
}
setwd('/home/polina/MMoDA')
getwd()
online.news.popularity <- read.csv(file="code/new_sample_OnlineNewsPopularity.csv",head=TRUE,sep=",")
online.news.popularity <- read.csv(file="code\new_sample_OnlineNewsPopularity.csv",head=TRUE,sep=",")
online.news.popularity <- read.csv(file="R-files/new_sample_OnlineNewsPopularity.csv",head=TRUE,sep=",")
normalize.range <- function(x) {
midrange <- (max(x) + min(x))/2
halfrange <- (max(x) - min(x))/2
y <- (x - midrange)/halfrange
y
}
#########################################################
### 1.Selection 3 features related to the same aspect ###
#########################################################
# From previous hometask
n <- ncol(online.news.popularity)
data <- online.news.popularity[,-c(1,2,n)]
data <- subset(data, n_tokens_content > 0)
data <- apply(data, MARGIN = 2,  function(x) {
y <- (x - mean(x))/sd(x)
y
})
data <- data.frame(data)
label <- ifelse(data[,25] < 0 & data[,26] < 0 & data[,27] > 0 & data[,28] < 0 & data[,29] > 0,1,
ifelse(data[,25] > 0 & data[,26] > 0 & data[,27] < 0 & data[,28] > 0 & data[,29] < 0, 2, 3))
bad.index <- which(label == 3)
features <- c(25:27)
colnames(data)[features]
n <- ncol(online.news.popularity)
data <- online.news.popularity[,-c(1,2,n)]
data <- subset(data, n_tokens_content > 0)
data <- data[,features]
data <- data[-bad.index,]
label <- label[-bad.index]
data.nrm.range <- as.data.frame(apply(data, MARGIN = 2, normalize.range))
data.nrm.std <- scale(data, center = TRUE, scale = TRUE)
pca.std <- prcomp(data.nrm.std)
biplot(pca.std)
pca.range <- prcomp(data.nrm.range)
biplot(pca.range)
s <- svd(data)
u <- s$u[,1:2]
v <- s$v[,1:2]
X.proj <- data %*% v
plot(s$d)
u
v
svd(data.nrm.std)$u
hf.range <- svd(data.nrm.range)$u[,1]
hf.std <- svd(data.nrm.std)$u[,1]
hf.std
temp <- hf.std %*% svd(data.nrm.std)$v[,1]
svd(data.nrm.std)$v
temp <- hf.std %*% svd(data.nrm.std)$v[1,]
temp <- hf.std %*% t(svd(data.nrm.std)$v[1,])
temp
data.nrm.std
apply(data.nrm.std - temp, MARGIN = 2, mean)
plot(pca.std$x[,1], pca.std$x[,2], col = label)
plot(pca.range$x[,1], pca.range[,2], col = label)
pca.range <- prcomp(data.nrm.range)
plot(pca.range$x[,1], pca.range[,2], col = label)
plot(pca.std$x[,1], pca.std$x[,2], col = label)
plot(pca.range$x[,1], pca.range$x[,2], col = label)
v <- c(1,2,3,1,1,4,5,1)
v <- (v == 1)*1
v
v <- c(1,2,3,1,1,4,5,1)
v <- (v == 2)*2
v
v <- c(1,2,3,1,1,4,5,1)
ifelse(v==1, 2,0)
