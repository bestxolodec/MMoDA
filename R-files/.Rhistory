colnames(data)
library(lattice)
library(e1071)
set.seed(123)
online.news.popularity <- read.csv(file="new_sample_OnlineNewsPopularity.csv",head=TRUE,sep=",")
normalize.range <- function(x) {
midrange <- (max(x) + min(x))/2
halfrange <- (max(x) - min(x))/2
y <- (x - midrange)/halfrange
y
}
n <- ncol(online.news.popularity)
data <- online.news.popularity[,-c(1,2,n)]
data <- transform(data, num_hrefs = log(num_hrefs), num_self_hrefs = log(num_self_hrefs),
self_reference_avg_sharess = log(self_reference_avg_sharess),
shares = log(shares), n_tokens_content = log(n_tokens_content))
data[data == -Inf] = -4000
colnames(data)
features <- c(25:27)
colnames(data)[features]
?scale
?pca
label <- ifelse(data[,25] < 0 & data[,26] < 0 & data[,27] > 0 & data[,28] < 0 & data[,29] > 0,1,
ifelse(data[,25] > 0 & data[,26] > 0 & data[,27] < 0 & data[,28] > 0 & data[,29] < 0, 2, 3))
bad.index <- which(label == 3)
data <- data[,features]
data <- online.news.popularity[,-c(1,2,n)]
label <- ifelse(data[,25] < 0 & data[,26] < 0 & data[,27] > 0 & data[,28] < 0 & data[,29] > 0,1,
ifelse(data[,25] > 0 & data[,26] > 0 & data[,27] < 0 & data[,28] > 0 & data[,29] < 0, 2, 3))
bad.index <- which(label == 3)
data <- data[,features]
data.nrm.range <- as.data.frame(apply(data, MARGIN = 2, normalize.range))
data.nrm.std <- scale(data, center = TRUE, scale = TRUE)
data.pca <- prcomp(data.nrm.range[ind,-c(10:15, 17:23, self.shares.ind)])
data.pca <- prcomp(data.nrm.range)
biplot(data.pca)
data.pca <- prcomp(data.nrm.std)
biplot(data.pca)
biplot(data.pca, col = label)
table(label)
data <- online.news.popularity[,-c(1,2,n)]
label <- ifelse(data[,25] < 0 & data[,26] < 0 & data[,27] > 0 & data[,28] < 0 & data[,29] > 0,1,
ifelse(data[,25] > 0 & data[,26] > 0 & data[,27] < 0 & data[,28] > 0 & data[,29] < 0, 2, 3))
table(label)
label <- ifelse(data[,25] < 0 & data[,26] < 0 & data[,27] > 0 & data[,28] < 0 & data[,29] > 0,1,
ifelse(data[,25] > 0 & data[,26] > 0 & data[,27] < 0 & data[,28] > 0 & data[,29] < 0, 2, 3))
colnames(data)[25:29]
table(label)
View(data)
n <- ncol(online.news.popularity)
data <- online.news.popularity[,-c(1,2,n)]
data <- subset(data, n_tokens_content > 0)
label <- ifelse(data[,25] < 0 & data[,26] < 0 & data[,27] > 0 & data[,28] < 0 & data[,29] > 0,1,
ifelse(data[,25] > 0 & data[,26] > 0 & data[,27] < 0 & data[,28] > 0 & data[,29] < 0, 2, 3))
table(label)
n <- ncol(online.news.popularity)
data <- online.news.popularity[,-c(1,2,n)]
data <- subset(data, n_tokens_content > 0)
data <- data.frame(data)
colnames(data)[25:29]
label <- ifelse(data[,25] < 0 & data[,26] < 0 & data[,27] > 0 & data[,28] < 0 & data[,29] > 0,1,
ifelse(data[,25] > 0 & data[,26] > 0 & data[,27] < 0 & data[,28] > 0 & data[,29] < 0, 2, 3))
table(label)
label <- ifelse(data[,25] < 0 & data[,26] < 0 & data[,27] > 0 & data[,28] < 0 & data[,29] > 0,1,
ifelse(data[,25] > 0 & data[,26] > 0 & data[,27] < 0 & data[,28] > 0 & data[,29] < 0, 2, 3))
bad.index <- which(label == 3)
data <- apply(data, MARGIN = 2,  function(x) {
y <- (x - mean(x))/sd(x)
y
})
data <- data.frame(data)
label <- ifelse(data[,25] < 0 & data[,26] < 0 & data[,27] > 0 & data[,28] < 0 & data[,29] > 0,1,
ifelse(data[,25] > 0 & data[,26] > 0 & data[,27] < 0 & data[,28] > 0 & data[,29] < 0, 2, 3))
bad.index <- which(label == 3)
n <- ncol(online.news.popularity)
data <- online.news.popularity[,-c(1,2,n)]
data <- data[,features]
data.nrm.range <- as.data.frame(apply(data, MARGIN = 2, normalize.range))
data.nrm.std <- scale(data, center = TRUE, scale = TRUE)
data.pca <- prcomp(data.nrm.std)
biplot(data.pca)
biplot(data.pca, col = label)
table(label)
data <- online.news.popularity[,-c(1,2,n)]
data <- subset(data, n_tokens_content > 0)
data <- apply(data, MARGIN = 2,  function(x) {
y <- (x - mean(x))/sd(x)
y
})
data <- data.frame(data)
label <- ifelse(data[,25] < 0 & data[,26] < 0 & data[,27] > 0 & data[,28] < 0 & data[,29] > 0,1,
ifelse(data[,25] > 0 & data[,26] > 0 & data[,27] < 0 & data[,28] > 0 & data[,29] < 0, 2, 3))
bad.index <- which(label == 3)
features <- c(25:27)
colnames(data)[features]
n <- ncol(online.news.popularity)
data <- online.news.popularity[,-c(1,2,n)]
data <- subset(data, n_tokens_content > 0)
data <- data[,features]
data.nrm.range <- as.data.frame(apply(data, MARGIN = 2, normalize.range))
data.nrm.std <- scale(data, center = TRUE, scale = TRUE)
data.pca <- prcomp(data.nrm.std)
biplot(data.pca, col = label)
data <- data[-bad.index,]
label <- label[-bad.index]
data.nrm.range <- as.data.frame(apply(data, MARGIN = 2, normalize.range))
data.nrm.std <- scale(data, center = TRUE, scale = TRUE)
data.pca <- prcomp(data.nrm.std)
biplot(data.pca, col = label)
?prcomp
data.pca$x
summary(data.pca$x)
biplot(data.pca$x[,1],data.pca$x[,2], col = label)
data.pca$x[,1]
biplot(data.pca$x[,1], data.pca$x[,2], col = label)
data.pca$x[,2]
data.pca <- prcomp(data.nrm.std)
biplot(data.pca$x[,1], data.pca$x[,2], col = label)
data.nrm.range <- as.data.frame(apply(data, MARGIN = 2, normalize.range))
data.nrm.std <- scale(data, center = TRUE, scale = TRUE)
data.pca <- prcomp(data.nrm.std)
data.pca$x[,2]
data.pca <- prcomp(data.nrm.std)
biplot(data.pca$x[,1], data.pca$x[,2], col = label)
data.pca
biplot(data.pca$x[,1], data.pca$x[,2], col = label)
head(data.pca$x)
dim(data.pca$x)
length(data.pca$x[,1])
length(data.pca$x[,2])
biplot(data.pca$x[,1], data.pca$x[,2], col = label)
plot(data.pca$x[,1], data.pca$x[,2], col = label)
xyplot(data.pca$x[,1], data.pca$x[,2], col = label)
xyplot(data.pca$x[,1] ~ data.pca$x[,2], col = label)
biplot(data.pca$x[,1], data.pca$x[,2], col = label)
biplot(data.pca)
library(ggplot2)
data.pca <- as.data.frame(data.pca$x)
ggplot(data = data.pca, aes(x = PC1, y = PC2)))
ggplot(data = data.pca, aes(x = PC1, y = PC2))
ggplot(data = data.pca, aes(x = PC1, y = PC2))+
geom_hline(yintercept = 0, colour = "gray65") +
geom_vline(xintercept = 0, colour = "gray65") +
geom_text(colour = "tomato", alpha = 0.8, size = 4) +
ggtitle("PCA plot of USA States - Crime Rates")
ggplot(data = data.pca, aes(x = PC1, y = PC2, label = label))+
geom_hline(yintercept = 0, colour = "gray65") +
geom_vline(xintercept = 0, colour = "gray65") +
geom_text(colour = "tomato", alpha = 0.8, size = 4) +
ggtitle("PCA plot of USA States - Crime Rates")
ggplot(data = data.pca, aes(x = PC1, y = PC2, label = label))+
geom_hline(yintercept = 0, colour = "gray65") +
geom_vline(xintercept = 0, colour = "gray65") +
geom_text(colour = label, alpha = 0.8, size = 4) +
ggtitle("PCA plot")
biplot(data.pca$x[,c(1,2)], col = label)
biplot(data.pca[,c(1,2)], col = label)
biplot(data.pca, col = label)
data.pca <- prcomp(data.nrm.std)
biplot(data.pca, col = label)
?biplot.prcomp
biplot(data.pca, col = c(1,2))
data.pca <- as.data.frame(data.pca$x)
# plot of observations
ggplot(data = data.pca, aes(x = PC1, y = PC2, label = label))+
geom_hline(yintercept = 0, colour = "gray65") +
geom_vline(xintercept = 0, colour = "gray65") +
geom_text(colour = label, alpha = 0.8, size = 4) +
ggtitle("PCA plot")
data.pca <- prcomp(data.nrm.range)
biplot(data.pca)
data.pca <- as.data.frame(data.pca$x)
ggplot(data = data.pca, aes(x = PC1, y = PC2, label = label))+
geom_hline(yintercept = 0, colour = "gray65") +
geom_vline(xintercept = 0, colour = "gray65") +
geom_text(colour = label, alpha = 0.8, size = 4) +
ggtitle("PCA plot")
par(mfrow = c(1,2))
ggplot(data = pca.std, aes(x = PC1, y = PC2, label = label))+
geom_hline(yintercept = 0, colour = "gray65") +
geom_vline(xintercept = 0, colour = "gray65") +
geom_text(colour = label, alpha = 0.8, size = 4) +
ggtitle("PCA plot")
ggplot(data = pca.range, aes(x = PC1, y = PC2, label = label))+
geom_hline(yintercept = 0, colour = "gray65") +
geom_vline(xintercept = 0, colour = "gray65") +
geom_text(colour = label, alpha = 0.8, size = 4) +
ggtitle("PCA plot")
pca.std <- prcomp(data.nrm.std)
biplot(pca.std)
pca.range <- prcomp(data.nrm.range)
biplot(pca.range)
pca.std <- as.data.frame(pca.std$x)
pca.range <- as.data.frame(pca.range$x)
ggplot(data = pca.std, aes(x = PC1, y = PC2, label = label))+
geom_hline(yintercept = 0, colour = "gray65") +
geom_vline(xintercept = 0, colour = "gray65") +
geom_text(colour = label, alpha = 0.8, size = 4) +
ggtitle("PCA plot")
ggplot(data = pca.range, aes(x = PC1, y = PC2, label = label))+
geom_hline(yintercept = 0, colour = "gray65") +
geom_vline(xintercept = 0, colour = "gray65") +
geom_text(colour = label, alpha = 0.8, size = 4) +
ggtitle("PCA plot")
par(mfrow = c(1,2))
ggplot(data = pca.std, aes(x = PC1, y = PC2, label = label))+
geom_hline(yintercept = 0, colour = "gray65") +
geom_vline(xintercept = 0, colour = "gray65") +
geom_text(colour = label, alpha = 0.8, size = 4) +
ggtitle("PCA plot")
ggplot(data = pca.range, aes(x = PC1, y = PC2, label = label))+
geom_hline(yintercept = 0, colour = "gray65") +
geom_vline(xintercept = 0, colour = "gray65") +
geom_text(colour = label, alpha = 0.8, size = 4) +
ggtitle("PCA plot")
windows()
x11()
par(mfrow = c(1,2))
ggplot(data = pca.std, aes(x = PC1, y = PC2, label = label))+
geom_hline(yintercept = 0, colour = "gray65") +
geom_vline(xintercept = 0, colour = "gray65") +
geom_text(colour = label, alpha = 0.8, size = 4) +
ggtitle("PCA plot")
ggplot(data = pca.range, aes(x = PC1, y = PC2, label = label))+
geom_hline(yintercept = 0, colour = "gray65") +
geom_vline(xintercept = 0, colour = "gray65") +
geom_text(colour = label, alpha = 0.8, size = 4) +
ggtitle("PCA plot")
ggplot(data = pca.std, aes(x = PC1, y = PC2, label = label))+
geom_hline(yintercept = 0, colour = "gray65") +
geom_vline(xintercept = 0, colour = "gray65") +
geom_text(colour = label, alpha = 0.8, size = 4) +
ggtitle("PCA plot")
